<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defense Strategy Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(to bottom right, #0f172a, #1e3a8a, #0f172a);
        }
        .glass {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(10px);
        }
        .progress-bar {
            background: linear-gradient(to right, #3b82f6, #06b6d4);
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        const gameState = {
            companyName: '',
            quarter: 1,
            maxQuarters: 12,
            valuation: 50,
            targetValuation: 1000,
            cash: 15,
            reputation: 70,
            talent: 60,
            govRelations: 50,
            contracts: 2,
            innovation: 50,
            gameStarted: false,
            gameOver: false,
            victory: false,
            currentScenario: null,
            eventLog: [],
            minReputation: 25,
            minTalent: 25,
            minGovRelations: 20
        };

        const strategies = {
            growth: {
                name: "Aggressive Growth",
                description: "Prioritize valuation and contracts. Higher rewards but higher risks.",
                effects: { valuationMultiplier: 1.3, riskMultiplier: 1.2, cashPenalty: 1.1 }
            },
            balanced: {
                name: "Balanced Approach", 
                description: "Steady growth with managed risk. Middle ground on all metrics.",
                effects: { valuationMultiplier: 1.0, riskMultiplier: 1.0, cashPenalty: 1.0 }
            },
            conservative: {
                name: "Risk-Averse",
                description: "Protect reputation and relationships. Slower growth but more stable.",
                effects: { valuationMultiplier: 0.8, riskMultiplier: 0.7, cashPenalty: 0.9 }
            }
        };

        const advisorTypes = {
            cfo: {
                conservative: { name: "Sarah Chen", specialty: "Cash management and financial stability", bias: "risk-averse" },
                aggressive: { name: "Marcus Webb", specialty: "Growth financing and M&A", bias: "growth-focused" }
            },
            cto: {
                innovative: { name: "Dr. Priya Sharma", specialty: "R&D and breakthrough technology", bias: "innovation-focused" },
                practical: { name: "James Rodriguez", specialty: "Execution and delivery", bias: "execution-focused" }
            },
            lobbyist: {
                connected: { name: "Victoria Hayes", specialty: "Government relations and contracts", bias: "relationship-focused" },
                independent: { name: "Tom Castellano", specialty: "Industry reputation and ethics", bias: "reputation-focused" }
            }
        };

        const randomEvents = [
            {
                title: "Key Employee Departure",
                description: "Your VP of Engineering accepts a position at SpaceX without warning.",
                effects: { talent: -15, innovation: -10, cash: -5 },
                icon: "üíî"
            },
            {
                title: "Audit Nightmare",
                description: "A surprise DCAA audit reveals accounting irregularities requiring expensive remediation.",
                effects: { cash: -10, govRelations: -15, reputation: -10 },
                icon: "üìã"
            },
            {
                title: "Security Clearance Delays",
                description: "Personnel security clearance delays push back your timeline on a critical program.",
                effects: { cash: -8, govRelations: -10, contracts: -1 },
                icon: "üîê"
            },
            {
                title: "Competitor Undercuts Pricing",
                description: "A well-funded competitor is bidding contracts at unsustainable prices, pressuring your margins.",
                effects: { cash: -7, reputation: -5, valuation: -15 },
                icon: "üí∏"
            },
            {
                title: "Trade Secret Theft Allegation",
                description: "A former employee's new employer accuses you of trade secret theft. Legal costs mount.",
                effects: { cash: -12, reputation: -20, govRelations: -15 },
                icon: "‚öñÔ∏è"
            },
            {
                title: "Failed Prototype Test",
                description: "A high-profile demonstration fails spectacularly. Video goes viral in defense circles.",
                effects: { reputation: -25, govRelations: -20, valuation: -20, talent: -10 },
                icon: "üí•"
            },
            {
                title: "Regulatory Compliance Issue",
                description: "New ITAR regulations require expensive system retrofits across your product line.",
                effects: { cash: -15, innovation: -10 },
                icon: "üìú"
            },
            {
                title: "Key Subcontractor Bankruptcy",
                description: "Your primary manufacturer files for Chapter 11. You need to find and qualify a new supplier fast.",
                effects: { cash: -10, innovation: -15, reputation: -10 },
                icon: "üè≠"
            }
        ];

        const scenarios = [
            {
                id: 1,
                title: "Major DoD RFP Opportunity",
                description: "The Department of Defense has issued an RFP for a $100M contract in autonomous systems. Competing requires significant upfront investment in proposal development and prototype demonstration.",
                icon: "üìã",
                options: [
                    {
                        text: "Go All-In: Commit $15M and top talent",
                        effects: { cash: -15, talent: -10, contracts: 1, valuation: 40, reputation: 15, govRelations: 20 },
                        outcome: "You assemble a world-class team and deliver an impressive proposal. The contract is yours!",
                        failureChance: 0.15,
                        failureOutcome: "Despite your best efforts, a competitor with deeper government connections wins the bid. You've burned through resources for nothing.",
                        failureEffects: { cash: -15, talent: -15, reputation: -10, govRelations: -5, valuation: -10 }
                    },
                    {
                        text: "Conservative Bid: Minimal investment approach",
                        effects: { cash: -5, contracts: 0, valuation: 5, reputation: -5 },
                        outcome: "You submit a solid but unremarkable proposal. The contract goes to a competitor."
                    },
                    {
                        text: "Pass: Focus on existing contracts",
                        effects: { cash: 5, reputation: -10, govRelations: -15 },
                        outcome: "You preserve resources but miss a major growth opportunity. Some see this as playing it too safe."
                    }
                ]
            },
            {
                id: 2,
                title: "Talent War: Key Engineer Poaching",
                description: "A Big Tech company is aggressively recruiting your lead AI engineer with a 2x salary offer. She's critical to your flagship program.",
                icon: "üéØ",
                options: [
                    {
                        text: "Counter-Offer: Match salary + equity",
                        effects: { cash: -8, talent: 10, innovation: 15, valuation: 20 },
                        outcome: "She stays and appreciates the recognition. Team morale improves significantly."
                    },
                    {
                        text: "Let Her Go: Promote from within",
                        effects: { cash: 2, talent: -20, innovation: -15, valuation: -15, reputation: -5 },
                        outcome: "The internal promotion struggles initially. You've lost institutional knowledge but saved cash."
                    },
                    {
                        text: "Negotiate: Flexible work + research time",
                        effects: { cash: -3, talent: 5, innovation: 10, reputation: 5 },
                        outcome: "A creative compromise keeps her engaged while managing costs."
                    }
                ]
            },
            {
                id: 3,
                title: "Supply Chain Crisis",
                description: "A key semiconductor supplier faces sanctions. Your production timeline for a $50M contract is at risk.",
                icon: "‚ö†Ô∏è",
                options: [
                    {
                        text: "Emergency Redesign: Switch to domestic chips",
                        effects: { cash: -12, innovation: -10, contracts: 0, reputation: 10, govRelations: 15 },
                        outcome: "Costly but demonstrates resilience and commitment to national security priorities."
                    },
                    {
                        text: "Delay & Negotiate: Request timeline extension",
                        effects: { cash: -3, reputation: -15, govRelations: -10, contracts: 0 },
                        outcome: "The delay frustrates your client but preserves your technical approach."
                    },
                    {
                        text: "Stockpile: Buy 2 years of inventory now",
                        effects: { cash: -20, innovation: 0, reputation: 5 },
                        outcome: "Massive cash outlay but you're protected against future disruptions."
                    }
                ]
            },
            {
                id: 4,
                title: "Acquisition Target",
                description: "A smaller defense tech startup with promising drone technology is looking for a buyer. They're asking $30M but are open to stock deals.",
                icon: "ü§ù",
                options: [
                    {
                        text: "Cash Acquisition: Buy outright",
                        effects: { cash: -30, talent: 15, innovation: 25, valuation: 60, contracts: 1 },
                        outcome: "You gain cutting-edge technology and a talented team. Integration goes smoothly.",
                        failureChance: 0.20,
                        failureOutcome: "The acquisition closes but key engineers leave during integration. The technology proves harder to productize than expected.",
                        failureEffects: { cash: -30, talent: -10, innovation: 5, valuation: 10, contracts: 0 }
                    },
                    {
                        text: "Stock Deal: Preserve cash",
                        effects: { cash: -5, talent: 15, innovation: 25, valuation: 40, contracts: 1 },
                        outcome: "The acquisition is successful and you've preserved precious cash for operations."
                    },
                    {
                        text: "Pass: Organic growth only",
                        effects: { cash: 5, innovation: 5, valuation: 10 },
                        outcome: "You continue your current trajectory. The startup gets acquired by a competitor."
                    }
                ]
            },
            {
                id: 5,
                title: "Congressional Hearing",
                description: "Your company is called to testify about cost overruns on a troubled program. Media attention is intense.",
                icon: "üèõÔ∏è",
                options: [
                    {
                        text: "Full Transparency: Admit mistakes, present fix",
                        effects: { cash: -5, reputation: 10, govRelations: 15, contracts: 0 },
                        outcome: "Your honesty is refreshing. You take a short-term hit but earn long-term trust."
                    },
                    {
                        text: "Deflect: Blame requirements changes",
                        effects: { cash: 0, reputation: -20, govRelations: -25, contracts: -1 },
                        outcome: "The committee sees through it. Your credibility takes a major hit."
                    },
                    {
                        text: "Technical Defense: Deep-dive presentation",
                        effects: { cash: -3, reputation: 5, govRelations: 5, talent: -5 },
                        outcome: "You avoid blame but the lengthy technical details bore the committee."
                    }
                ]
            },
            {
                id: 6,
                title: "R&D Breakthrough",
                description: "Your lab has achieved a breakthrough in quantum sensing. This could revolutionize defense tech, but productization requires $25M investment.",
                icon: "üî¨",
                options: [
                    {
                        text: "Full Investment: Rush to production",
                        effects: { cash: -25, innovation: 40, valuation: 80, reputation: 20 },
                        outcome: "You beat competitors to market. This becomes your flagship product line.",
                        failureChance: 0.25,
                        failureOutcome: "Technical challenges emerge during scale-up. The product works in the lab but production yields are terrible. You've invested heavily in a technology that's not ready.",
                        failureEffects: { cash: -25, innovation: 10, valuation: 15, reputation: -15, talent: -10 }
                    },
                    {
                        text: "Modest Investment: Pilot program only",
                        effects: { cash: -10, innovation: 15, valuation: 25 },
                        outcome: "You demonstrate the technology but lack the scale for major impact."
                    },
                    {
                        text: "License Technology: Let others productize",
                        effects: { cash: 15, innovation: -10, valuation: 10, reputation: -10 },
                        outcome: "Quick revenue but you've given away your competitive advantage."
                    }
                ]
            },
            {
                id: 7,
                title: "Cybersecurity Breach",
                description: "A sophisticated attack has compromised some development systems. No classified data was exposed, but clients are concerned.",
                icon: "üîí",
                options: [
                    {
                        text: "Immediate Disclosure: Notify all stakeholders",
                        effects: { cash: -8, reputation: 5, govRelations: 10, contracts: 0 },
                        outcome: "Your transparency is appreciated. You implement industry-leading security measures."
                    },
                    {
                        text: "Quiet Fix: Handle internally",
                        effects: { cash: -3, reputation: -25, govRelations: -30, contracts: -1 },
                        outcome: "The breach leaks anyway. The cover-up is worse than the crime."
                    },
                    {
                        text: "Major Security Overhaul: $15M investment",
                        effects: { cash: -15, reputation: 15, govRelations: 20, innovation: 5 },
                        outcome: "You become the gold standard for defense contractor security."
                    }
                ]
            },
            {
                id: 8,
                title: "International Expansion",
                description: "Allied nations are interested in your technology. Exporting requires State Department approval and additional compliance costs.",
                icon: "üåç",
                options: [
                    {
                        text: "Pursue Aggressively: Multi-nation strategy",
                        effects: { cash: -10, reputation: 20, valuation: 50, contracts: 2, govRelations: -5 },
                        outcome: "You secure contracts with UK, Australia, and Japan. Revenue diversification achieved."
                    },
                    {
                        text: "US-Only: Stay domestic",
                        effects: { cash: 5, govRelations: 10, valuation: 10 },
                        outcome: "You maintain simplicity but limit your total addressable market."
                    },
                    {
                        text: "Strategic Partnership: Joint venture approach",
                        effects: { cash: -5, reputation: 10, valuation: 25, contracts: 1 },
                        outcome: "You share risk and reward with international partners."
                    }
                ]
            },
            {
                id: 9,
                title: "Ethical Dilemma: Autonomous Weapons",
                description: "A lucrative contract requires developing fully autonomous lethal systems. Your technical team is divided on the ethics.",
                icon: "‚öñÔ∏è",
                options: [
                    {
                        text: "Accept Contract: Business is business",
                        effects: { cash: 20, talent: -25, reputation: -15, contracts: 1, valuation: 40 },
                        outcome: "Revenue increases but several key engineers resign. Public advocacy groups criticize you."
                    },
                    {
                        text: "Decline: Establish ethical guidelines",
                        effects: { cash: -5, talent: 15, reputation: 20, govRelations: -10, valuation: 15 },
                        outcome: "You become known for principled leadership. Talent acquisition improves dramatically."
                    },
                    {
                        text: "Compromise: Human-in-the-loop system",
                        effects: { cash: 10, talent: 5, reputation: 5, contracts: 1, valuation: 25 },
                        outcome: "You find middle ground that satisfies most stakeholders."
                    }
                ]
            },
            {
                id: 10,
                title: "IPO Opportunity",
                description: "Investment bankers suggest your company is ready to go public. An IPO could raise $100M but comes with scrutiny and pressure.",
                icon: "üìà",
                options: [
                    {
                        text: "Go Public: Launch IPO",
                        effects: { cash: 100, valuation: 150, reputation: 25, govRelations: 5, talent: -10 },
                        outcome: "Successful IPO! You gain capital but now answer to public shareholders."
                    },
                    {
                        text: "Private Equity: Raise privately",
                        effects: { cash: 60, valuation: 80, talent: 5 },
                        outcome: "You maintain more control while securing significant growth capital."
                    },
                    {
                        text: "Stay Independent: Bootstrap growth",
                        effects: { cash: 10, valuation: 20, talent: 10, reputation: 5 },
                        outcome: "You maintain full control but grow more slowly."
                    }
                ]
            },
            {
                id: 11,
                title: "Protest Contract: Competitor Files Dispute",
                description: "You've been awarded a $80M contract, but the losing bidder files a formal protest claiming evaluation bias. This could drag on for months.",
                icon: "‚ö†Ô∏è",
                options: [
                    {
                        text: "Aggressive Legal Defense: $20M war chest",
                        effects: { cash: -20, govRelations: -10, contracts: 1, valuation: 50, reputation: -5 },
                        outcome: "You win the protest decisively. The contract proceeds but you've made an enemy."
                    },
                    {
                        text: "Negotiate Settlement: Split the contract",
                        effects: { cash: -8, contracts: 0, valuation: 15, reputation: -15 },
                        outcome: "You agree to a reduced scope. Less revenue but avoids a prolonged legal battle."
                    },
                    {
                        text: "Wait It Out: Minimal legal spend",
                        effects: { cash: -5, talent: -15, reputation: -20, govRelations: -15 },
                        outcome: "The protest drags on for 9 months. By the time you win, you've lost key team members and momentum."
                    }
                ]
            },
            {
                id: 12,
                title: "Classified Breach Investigation",
                description: "A laptop containing classified information goes missing. FBI and DoD investigators descend on your facility.",
                icon: "üö®",
                options: [
                    {
                        text: "Full Cooperation: Transparent approach",
                        effects: { cash: -15, reputation: -10, govRelations: 5, talent: -10 },
                        outcome: "Investigation clears you of intentional wrongdoing. Your transparent approach is noted positively."
                    },
                    {
                        text: "Damage Control: PR and legal blitz",
                        effects: { cash: -25, reputation: 10, govRelations: -10, contracts: 0 },
                        outcome: "You minimize public perception damage but relationships with program managers suffer."
                    },
                    {
                        text: "Minimal Response: Hope it blows over",
                        effects: { cash: -5, reputation: -30, govRelations: -35, contracts: -2, valuation: -40 },
                        outcome: "This was a catastrophic mistake. Your facility clearance is suspended. Multiple contracts are terminated."
                    }
                ]
            },
            {
                id: 13,
                title: "Hostile Takeover Attempt",
                description: "A defense industry giant makes an unsolicited offer to acquire your company at a significant premium. Your board is divided.",
                icon: "üéØ",
                options: [
                    {
                        text: "Accept Offer: $200M premium exit",
                        effects: { cash: 200, valuation: 200, talent: -30, innovation: -20 },
                        outcome: "You accept the acquisition. Immediate value creation but you're no longer independent."
                    },
                    {
                        text: "Poison Pill Defense: Fight to stay independent",
                        effects: { cash: -30, talent: 10, valuation: 50, reputation: 10, govRelations: 5 },
                        outcome: "You successfully fend off the takeover. Team rallies around independence but it was expensive."
                    },
                    {
                        text: "White Knight: Seek friendly acquirer",
                        effects: { cash: -15, valuation: 80, talent: 5, reputation: 5 },
                        outcome: "You find a better cultural fit willing to keep you autonomous. A compromise solution."
                    }
                ]
            },
            {
                id: 14,
                title: "Geopolitical Crisis",
                description: "Tensions escalate in the Taiwan Strait. DoD is urgently seeking rapid capability development. This is your moment - if you can deliver.",
                icon: "üåè",
                options: [
                    {
                        text: "Emergency Response: 24/7 operations",
                        effects: { cash: -20, talent: -20, innovation: 20, contracts: 2, valuation: 100, govRelations: 30, reputation: 25 },
                        outcome: "You deliver critical capabilities in record time. You're now on the map as a tier-one contractor.",
                        failureChance: 0.30,
                        failureOutcome: "You overcommit and fail to deliver. Your reputation as a reliable partner is destroyed.",
                        failureEffects: { cash: -25, talent: -25, reputation: -35, govRelations: -40, contracts: -1, valuation: -50 }
                    },
                    {
                        text: "Measured Response: Work within limits",
                        effects: { cash: -10, contracts: 1, valuation: 30, govRelations: 10, reputation: 5 },
                        outcome: "You make a solid contribution without overextending. Safe but not spectacular."
                    },
                    {
                        text: "Pass: Too risky right now",
                        effects: { cash: 5, govRelations: -20, reputation: -15, valuation: -20 },
                        outcome: "When the nation needed you, you played it safe. This won't be forgotten."
                    }
                ]
            },
            {
                id: 15,
                title: "Insider Trading Allegation",
                description: "The SEC is investigating suspicious stock trades by your CFO ahead of a major contract announcement.",
                icon: "üìä",
                options: [
                    {
                        text: "Fire CFO Immediately: Distance the company",
                        effects: { cash: -10, reputation: 5, talent: -15, govRelations: 5 },
                        outcome: "Swift action limits damage. Finding a replacement CFO with security clearance takes months."
                    },
                    {
                        text: "Stand By CFO: Internal investigation first",
                        effects: { cash: -5, reputation: -25, govRelations: -20, valuation: -30 },
                        outcome: "Your loyalty backfires. The evidence is damning and your reputation suffers by association."
                    },
                    {
                        text: "Cooperate with SEC: Full transparency",
                        effects: { cash: -15, reputation: 10, talent: -10, govRelations: 15 },
                        outcome: "The investigation exonerates the company but not the CFO. Your cooperation is appreciated."
                    }
                ]
            },
            {
                id: 16,
                title: "Patent Infringement Lawsuit",
                description: "A patent troll claims your core technology infringes on their portfolio. They're demanding $40M or a lengthy court battle.",
                icon: "‚öñÔ∏è",
                options: [
                    {
                        text: "Fight It: Take them to court",
                        effects: { cash: -18, reputation: 10, innovation: 0 },
                        outcome: "After 18 months, you win decisively. The patents are invalidated. Expensive but you stood your ground."
                    },
                    {
                        text: "Settle: Pay $15M licensing fee",
                        effects: { cash: -15, reputation: -5, innovation: -5 },
                        outcome: "You settle to avoid distraction. It stings but you move on quickly."
                    },
                    {
                        text: "Redesign: Engineer around the patents",
                        effects: { cash: -10, innovation: 15, talent: -10 },
                        outcome: "Your team finds a better technical solution. Turned a threat into an opportunity."
                    }
                ]
            },
            {
                id: 17,
                title: "Executive Burnout Crisis",
                description: "Your COO, who's been working 80-hour weeks, suffers a health crisis. The team is exhausted and turnover is rising.",
                icon: "üò∞",
                options: [
                    {
                        text: "Mandatory Sabbaticals: Force breaks for leadership",
                        effects: { cash: -8, talent: 15, innovation: 5, reputation: 10 },
                        outcome: "Productivity dips short-term but morale soars. You're building a sustainable culture."
                    },
                    {
                        text: "Hire More Executives: Distribute the load",
                        effects: { cash: -12, talent: 10, govRelations: 5 },
                        outcome: "Fresh blood brings new ideas and relieves pressure. Integration takes time but it works."
                    },
                    {
                        text: "Push Through: Mission comes first",
                        effects: { cash: 5, talent: -25, reputation: -15, innovation: -10 },
                        outcome: "Three more senior leaders resign within a month. Your reputation as an employer tanks."
                    }
                ]
            },
            {
                id: 18,
                title: "AI Ethics Controversy",
                description: "Media reports claim your AI-powered targeting system has unacceptable bias. Advocacy groups are calling for investigations.",
                icon: "ü§ñ",
                options: [
                    {
                        text: "Independent Audit: Bring in external experts",
                        effects: { cash: -10, reputation: 15, innovation: -5, govRelations: 10 },
                        outcome: "The audit finds issues you fix proactively. Your transparency becomes a competitive advantage."
                    },
                    {
                        text: "Double Down: Defend the technology",
                        effects: { cash: 0, reputation: -20, govRelations: -15, talent: -15 },
                        outcome: "Your defensive posture backfires. Top AI researchers refuse to work with you."
                    },
                    {
                        text: "Pause Deployment: Voluntary moratorium",
                        effects: { cash: -12, contracts: -1, reputation: 20, talent: 10 },
                        outcome: "You take a financial hit but win praise for ethical leadership. Long-term trust grows."
                    }
                ]
            },
            {
                id: 19,
                title: "Foreign Investment Offer",
                description: "A sovereign wealth fund from an allied nation offers $100M investment at favorable terms. CFIUS review required.",
                icon: "üí∞",
                options: [
                    {
                        text: "Accept Investment: Navigate CFIUS approval",
                        effects: { cash: 100, valuation: 120, govRelations: -10, reputation: 5 },
                        outcome: "CFIUS approves with conditions. You've got capital but increased scrutiny."
                    },
                    {
                        text: "Decline: Stay domestic-only",
                        effects: { cash: 0, govRelations: 15, valuation: 10 },
                        outcome: "You prioritize simplicity and government trust over capital."
                    },
                    {
                        text: "Counter-Offer: Seek US investors instead",
                        effects: { cash: 60, valuation: 70, govRelations: 10, reputation: 10 },
                        outcome: "You raise domestically at a lower valuation. Cleaner cap table, less money."
                    }
                ]
            },
            {
                id: 20,
                title: "Unionization Drive",
                description: "Engineers are organizing. They're demanding better work-life balance, more transparency, and equity adjustments.",
                icon: "‚úä",
                options: [
                    {
                        text: "Embrace Union: Work collaboratively",
                        effects: { cash: -10, talent: 20, innovation: 10, reputation: 15 },
                        outcome: "You're one of the few defense contractors with a positive union relationship. Talent acquisition improves."
                    },
                    {
                        text: "Fight Union: Anti-union campaign",
                        effects: { cash: -15, talent: -30, reputation: -25, innovation: -15 },
                        outcome: "You win the vote but at devastating cost. Best engineers leave. Culture is poisoned."
                    },
                    {
                        text: "Preempt: Major compensation overhaul",
                        effects: { cash: -20, talent: 15, innovation: 5, reputation: 10 },
                        outcome: "You address concerns before the vote. Expensive but effective."
                    }
                ]
            },
            {
                id: 21,
                title: "Manufacturing Defect Recall",
                description: "A critical component in 200 delivered units has a defect. No failures yet, but testing reveals potential safety issues.",
                icon: "üîß",
                options: [
                    {
                        text: "Immediate Recall: Proactive approach",
                        effects: { cash: -25, reputation: 20, govRelations: 25, contracts: 0 },
                        outcome: "The recall is expensive but earns enormous goodwill. You're seen as putting safety first."
                    },
                    {
                        text: "Silent Fix: Repair during maintenance",
                        effects: { cash: -8, reputation: -30, govRelations: -40, contracts: -2 },
                        outcome: "A whistleblower leaks your decision. The cover-up scandal is catastrophic."
                    },
                    {
                        text: "Engineering Analysis: Verify risk level first",
                        effects: { cash: -5, reputation: 5, govRelations: 0 },
                        outcome: "Analysis shows the risk is minimal. You implement enhanced monitoring instead of full recall."
                    }
                ]
            },
            {
                id: 22,
                title: "Competitor Acquires Your Supplier",
                description: "Your largest competitor just bought your primary component supplier. They're now controlling your supply chain.",
                icon: "üè≠",
                options: [
                    {
                        text: "Vertical Integration: Buy a manufacturer",
                        effects: { cash: -40, innovation: 20, valuation: 50, contracts: 0 },
                        outcome: "Expensive but you now control your destiny. Long-term strategic advantage."
                    },
                    {
                        text: "Diversify Suppliers: Multi-source strategy",
                        effects: { cash: -15, innovation: -5, reputation: 5 },
                        outcome: "You spread risk but lose some economies of scale. Safer but not optimal."
                    },
                    {
                        text: "Negotiate: Maintain relationship",
                        effects: { cash: -5, reputation: -10, govRelations: 0 },
                        outcome: "Your competitor plays fair... for now. You're vulnerable but avoid major expense."
                    }
                ]
            },
            {
                id: 23,
                title: "Data Center Ransomware Attack",
                description: "Ransomware has encrypted your product data. Hackers demand $5M in Bitcoin. You have backups but they're 2 weeks old.",
                icon: "üîê",
                options: [
                    {
                        text: "Pay Ransom: Get data back quickly",
                        effects: { cash: -5, reputation: -15, govRelations: -20 },
                        outcome: "Data recovered but you've funded criminals. Government clients question your security."
                    },
                    {
                        text: "Restore Backups: Take the delay",
                        effects: { cash: -10, contracts: -1, reputation: 10, talent: -10 },
                        outcome: "You lose 2 weeks of work. Team works overtime to catch up. The right call but painful."
                    },
                    {
                        text: "Full Rebuild: Upgrade security simultaneously",
                        effects: { cash: -20, innovation: 10, reputation: 15, govRelations: 10 },
                        outcome: "You turn crisis into opportunity. Your new infrastructure is best-in-class."
                    }
                ]
            },
            {
                id: 24,
                title: "Breakthrough or Breakthrough?",
                description: "Your research team claims a major breakthrough in quantum computing. But it needs validation and the lead scientist wants to publish.",
                icon: "üî¨",
                options: [
                    {
                        text: "Allow Publication: Open science approach",
                        effects: { cash: 10, innovation: 25, reputation: 25, valuation: 30, contracts: -1 },
                        outcome: "You win prestige and top talent but give away competitive advantage. Some clients are unhappy."
                    },
                    {
                        text: "Classify & Patent: Keep it proprietary",
                        effects: { cash: -10, innovation: 30, valuation: 80, talent: -15, reputation: -10 },
                        outcome: "Major commercial advantage but your lead scientist leaves for academia."
                    },
                    {
                        text: "Validate First: Independent verification",
                        effects: { cash: -8, innovation: 15, reputation: 15 },
                        outcome: "Turns out the breakthrough needs more work. You avoided premature announcements."
                    }
                ]
            },
            {
                id: 25,
                title: "Congressional Budget Cuts",
                description: "The defense budget is being slashed 15%. Programs are being cancelled. Your largest contract is under review.",
                icon: "üìâ",
                options: [
                    {
                        text: "Aggressive Lobbying: Fight for funding",
                        effects: { cash: -12, govRelations: 15, contracts: 1, reputation: -10 },
                        outcome: "Your lobbying works. Contract saved but you're seen as a typical defense contractor."
                    },
                    {
                        text: "Pivot Commercial: Dual-use technology",
                        effects: { cash: -15, innovation: 20, valuation: 40, contracts: -1 },
                        outcome: "You successfully pivot some tech to commercial markets. Diversification achieved."
                    },
                    {
                        text: "Downsize: Cut costs aggressively",
                        effects: { cash: 15, talent: -30, innovation: -20, reputation: -15 },
                        outcome: "You survive but lose key people and capabilities. A shell of what you were."
                    }
                ]
            },
            {
                id: 26,
                title: "Whistleblower Allegation",
                description: "An employee reports suspected accounting fraud in your contracts division to the DOJ. Investigation launched.",
                icon: "üì¢",
                options: [
                    {
                        text: "Internal Investigation: Root out the truth",
                        effects: { cash: -15, reputation: 10, govRelations: 15, talent: -10 },
                        outcome: "You find legitimate issues and self-report. Painful but you maintain integrity."
                    },
                    {
                        text: "Aggressive Defense: Attack credibility",
                        effects: { cash: -20, reputation: -35, govRelations: -40, contracts: -2 },
                        outcome: "The evidence proves the whistleblower right. Your reputation is destroyed."
                    },
                    {
                        text: "Cooperate Fully: Maximum transparency",
                        effects: { cash: -10, reputation: 20, govRelations: 25, talent: 5 },
                        outcome: "Investigation clears the company. Your cooperation is noted positively."
                    }
                ]
            },
            {
                id: 27,
                title: "Key Technical Milestone Failure",
                description: "Your flagship program just failed a critical technical demonstration in front of Pentagon officials. Confidence is shaken.",
                icon: "üí•",
                options: [
                    {
                        text: "Root Cause Analysis: Systematic approach",
                        effects: { cash: -8, innovation: 10, reputation: 5, govRelations: 5 },
                        outcome: "You identify and fix the real issue. Takes time but restores confidence."
                    },
                    {
                        text: "Quick Fix: Band-aid solution",
                        effects: { cash: -3, innovation: -10, reputation: -15, govRelations: -15 },
                        outcome: "The fix doesn't address root cause. Next demo also fails. Credibility shot."
                    },
                    {
                        text: "Redesign: Admit fundamental flaw",
                        effects: { cash: -25, innovation: 20, reputation: 15, govRelations: 10, contracts: -1 },
                        outcome: "Admitting the problem and fixing it properly earns respect. Expensive but right."
                    }
                ]
            },
            {
                id: 28,
                title: "ESG Investment Pressure",
                description: "Major institutional investors demand you adopt stringent environmental and social governance standards or they'll divest.",
                icon: "üå±",
                options: [
                    {
                        text: "Full ESG Commitment: Comprehensive program",
                        effects: { cash: -18, reputation: 25, talent: 20, valuation: 40 },
                        outcome: "You attract impact investors and mission-driven talent. Market loves it."
                    },
                    {
                        text: "Minimal Compliance: Check the boxes",
                        effects: { cash: -5, reputation: -10, talent: -5 },
                        outcome: "You do the minimum. Investors see through it. Opportunity wasted."
                    },
                    {
                        text: "Push Back: Defense of defense sector",
                        effects: { cash: 0, reputation: -15, valuation: -20, talent: -10 },
                        outcome: "Some investors appreciate your stance but most walk away. Access to capital suffers."
                    }
                ]
            },
            {
                id: 29,
                title: "Viral Social Media Crisis",
                description: "A video of your weapons system in action goes viral with the caption 'This is what your tax dollars buy.' Public backlash is intense.",
                icon: "üì±",
                options: [
                    {
                        text: "Transparent Engagement: Explain the mission",
                        effects: { cash: -5, reputation: 10, talent: 5, govRelations: 10 },
                        outcome: "Your thoughtful response thread gets shared widely. You win some hearts and minds."
                    },
                    {
                        text: "No Comment: Let it blow over",
                        effects: { cash: 0, reputation: -20, talent: -15 },
                        outcome: "Silence is interpreted as guilt. The story dominates news cycles for weeks."
                    },
                    {
                        text: "Counter-Campaign: Patriotic messaging",
                        effects: { cash: -10, reputation: 5, govRelations: 15, talent: -5 },
                        outcome: "Your campaign resonates with some but feels tone-deaf to others. Mixed results."
                    }
                ]
            },
            {
                id: 30,
                title: "Founder's Dilemma",
                description: "Your co-founder wants to take the company in a radically different direction. The board is divided. This could split the company.",
                icon: "ü§ù",
                options: [
                    {
                        text: "Buy Them Out: Maintain your vision",
                        effects: { cash: -35, talent: -15, valuation: 30, reputation: -5 },
                        outcome: "Expensive and emotionally draining but you maintain control of your vision."
                    },
                    {
                        text: "Compromise: Merge both visions",
                        effects: { cash: -10, innovation: 15, talent: 10, reputation: 5 },
                        outcome: "The hybrid approach is messy but shows both ideas have merit. Unity preserved."
                    },
                    {
                        text: "Step Aside: Let them lead",
                        effects: { cash: 20, valuation: -30, talent: -20, govRelations: -10 },
                        outcome: "You take a board seat but lose operational control. Hard to watch from the sidelines."
                    }
                ]
            }
        ];

        function render() {
            const app = document.getElementById('app');
            
            if (!gameState.gameStarted) {
                app.innerHTML = `
                    <div class="min-h-screen gradient-bg p-8 flex items-center justify-center">
                        <div class="max-w-4xl w-full glass border border-blue-500/30 rounded-lg p-8 shadow-2xl">
                            <div class="text-center mb-8">
                                <h1 class="text-5xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-4">
                                    DEFENSE STRATEGY SIMULATOR
                                </h1>
                                <p class="text-slate-300 text-lg">Lead your defense technology startup to unicorn status</p>
                            </div>
                            
                            <div class="bg-slate-900/50 rounded-lg p-6 mb-6 border border-blue-500/20">
                                <h2 class="text-xl font-semibold text-blue-300 mb-4">MISSION BRIEF</h2>
                                <div class="space-y-3 text-slate-300">
                                    <div class="flex items-start gap-3">
                                        <span class="text-cyan-400 text-xl">üéØ</span>
                                        <div>
                                            <span class="font-semibold text-cyan-400">Objective:</span> Reach ${gameState.targetValuation}M valuation in ${gameState.maxQuarters} quarters
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <span class="text-green-400 text-xl">üí∞</span>
                                        <div>
                                            <span class="font-semibold text-green-400">Starting Capital:</span> ${gameState.cash}M
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <span class="text-yellow-400 text-xl">‚ö†Ô∏è</span>
                                        <div>
                                            <span class="font-semibold text-yellow-400">Challenge:</span> Navigate complex strategic decisions balancing growth, reputation, and resources
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-slate-900/50 rounded-lg p-6 mb-6 border border-red-500/20">
                                <h2 class="text-xl font-semibold text-red-300 mb-4">FAILURE CONDITIONS</h2>
                                <div class="grid grid-cols-2 gap-3 text-sm text-slate-300">
                                    <div class="flex items-center gap-2">
                                        <span class="text-red-400">üí∏</span>
                                        <span>Cash reaches $0</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-red-400">üìâ</span>
                                        <span>Reputation &lt; ${gameState.minReputation}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-red-400">üë•</span>
                                        <span>Talent &lt; ${gameState.minTalent}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <span class="text-red-400">üèõÔ∏è</span>
                                        <span>Gov Relations &lt; ${gameState.minGovRelations}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="block text-slate-300 font-semibold mb-2">Company Name</label>
                                <input
                                    type="text"
                                    id="companyNameInput"
                                    placeholder="Enter your company name..."
                                    class="w-full bg-slate-900/50 border border-blue-500/30 rounded-lg px-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:border-blue-400 transition-colors"
                                />
                            </div>

                            <div class="mb-4">
                                <label class="block text-slate-300 font-semibold mb-2">Select Your Strategy</label>
                                <div class="grid grid-cols-3 gap-3">
                                    ${Object.keys(strategies).map(key => `
                                        <button
                                            onclick="selectStrategy('${key}')"
                                            id="strategy-${key}"
                                            class="strategy-btn bg-slate-900/50 border-2 border-blue-500/30 hover:border-cyan-400/60 rounded-lg p-4 text-left transition-all"
                                        >
                                            <div class="text-cyan-400 font-semibold mb-1">${strategies[key].name}</div>
                                            <div class="text-slate-400 text-xs">${strategies[key].description}</div>
                                        </button>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="mb-6">
                                <label class="block text-slate-300 font-semibold mb-2">Select Your Advisors</label>
                                <div class="space-y-3">
                                    <div>
                                        <div class="text-sm text-slate-400 mb-1">Chief Financial Officer</div>
                                        <div class="grid grid-cols-2 gap-2">
                                            ${Object.keys(advisorTypes.cfo).map(key => `
                                                <button
                                                    onclick="selectAdvisor('cfo', '${key}')"
                                                    id="advisor-cfo-${key}"
                                                    class="advisor-btn bg-slate-900/50 border border-blue-500/30 hover:border-cyan-400/60 rounded p-3 text-left text-sm transition-all"
                                                >
                                                    <div class="text-cyan-300 font-semibold">${advisorTypes.cfo[key].name}</div>
                                                    <div class="text-slate-400 text-xs">${advisorTypes.cfo[key].specialty}</div>
                                                </button>
                                            `).join('')}
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-sm text-slate-400 mb-1">Chief Technology Officer</div>
                                        <div class="grid grid-cols-2 gap-2">
                                            ${Object.keys(advisorTypes.cto).map(key => `
                                                <button
                                                    onclick="selectAdvisor('cto', '${key}')"
                                                    id="advisor-cto-${key}"
                                                    class="advisor-btn bg-slate-900/50 border border-blue-500/30 hover:border-cyan-400/60 rounded p-3 text-left text-sm transition-all"
                                                >
                                                    <div class="text-cyan-300 font-semibold">${advisorTypes.cto[key].name}</div>
                                                    <div class="text-slate-400 text-xs">${advisorTypes.cto[key].specialty}</div>
                                                </button>
                                            `).join('')}
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-sm text-slate-400 mb-1">Government Relations Lead</div>
                                        <div class="grid grid-cols-2 gap-2">
                                            ${Object.keys(advisorTypes.lobbyist).map(key => `
                                                <button
                                                    onclick="selectAdvisor('lobbyist', '${key}')"
                                                    id="advisor-lobbyist-${key}"
                                                    class="advisor-btn bg-slate-900/50 border border-blue-500/30 hover:border-cyan-400/60 rounded p-3 text-left text-sm transition-all"
                                                >
                                                    <div class="text-cyan-300 font-semibold">${advisorTypes.lobbyist[key].name}</div>
                                                    <div class="text-slate-400 text-xs">${advisorTypes.lobbyist[key].specialty}</div>
                                                </button>
                                            `).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button
                                onclick="startGame()"
                                class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white font-semibold py-3 rounded-lg transition-all shadow-lg hover:shadow-cyan-500/50 disabled:opacity-50 disabled:cursor-not-allowed"
                                id="startButton"
                                disabled
                            >
                                LAUNCH COMPANY
                            </button>
                            <div id="startError" class="text-red-400 text-sm text-center mt-2 hidden">
                                Please enter a company name and select a strategy and all advisors
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('companyNameInput').addEventListener('input', checkStartReady);
                return;
            }

            if (gameState.gameOver) {
                app.innerHTML = `
                    <div class="min-h-screen gradient-bg p-8 flex items-center justify-center">
                        <div class="max-w-3xl w-full glass border border-blue-500/30 rounded-lg p-8 shadow-2xl">
                            <div class="text-center mb-8">
                                <h1 class="text-5xl font-bold mb-4">
                                    ${gameState.victory ? 
                                        '<span class="bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent">üéâ MISSION SUCCESS üéâ</span>' :
                                        '<span class="bg-gradient-to-r from-red-400 to-orange-400 bg-clip-text text-transparent">MISSION FAILED</span>'
                                    }
                                </h1>
                                <p class="text-slate-300 text-xl">${gameState.companyName}</p>
                            </div>

                            <div class="grid grid-cols-2 gap-4 mb-8">
                                <div class="bg-slate-900/50 rounded-lg p-4 border border-blue-500/20">
                                    <div class="text-slate-400 text-sm mb-1">Final Valuation</div>
                                    <div class="text-3xl font-bold text-cyan-400">$${gameState.valuation}M</div>
                                </div>
                                <div class="bg-slate-900/50 rounded-lg p-4 border border-blue-500/20">
                                    <div class="text-slate-400 text-sm mb-1">Target</div>
                                    <div class="text-3xl font-bold text-blue-400">$${gameState.targetValuation}M</div>
                                </div>
                                <div class="bg-slate-900/50 rounded-lg p-4 border border-blue-500/20">
                                    <div class="text-slate-400 text-sm mb-1">Cash Remaining</div>
                                    <div class="text-2xl font-bold text-green-400">$${gameState.cash}M</div>
                                </div>
                                <div class="bg-slate-900/50 rounded-lg p-4 border border-blue-500/20">
                                    <div class="text-slate-400 text-sm mb-1">Quarters Elapsed</div>
                                    <div class="text-2xl font-bold text-purple-400">${gameState.quarter - 1}</div>
                                </div>
                            </div>

                            <div class="bg-slate-900/50 rounded-lg p-6 mb-6 border border-blue-500/20 max-h-64 overflow-y-auto">
                                <h2 class="text-xl font-semibold text-blue-300 mb-4">COMPANY HISTORY</h2>
                                <div class="space-y-2">
                                    ${gameState.eventLog.map(log => `<div class="text-slate-300 text-sm">${log}</div>`).join('')}
                                </div>
                            </div>

                            <button
                                onclick="resetGame()"
                                class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white font-semibold py-3 rounded-lg transition-all shadow-lg hover:shadow-cyan-500/50"
                            >
                                START NEW COMPANY
                            </button>
                        </div>
                    </div>
                `;
                return;
            }

            // Main game screen
            const progressPercent = Math.min(100, (gameState.valuation / gameState.targetValuation) * 100);
            
            app.innerHTML = `
                <div class="min-h-screen gradient-bg p-6">
                    <div class="max-w-7xl mx-auto">
                        <!-- Header -->
                        <div class="glass border border-blue-500/30 rounded-lg p-6 mb-6 shadow-xl">
                            <div class="flex justify-between items-center mb-4">
                                <div>
                                    <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">
                                        ${gameState.companyName}
                                    </h1>
                                    <p class="text-slate-400">Quarter ${gameState.quarter} of ${gameState.maxQuarters}</p>
                                </div>
                                <div class="text-right">
                                    <div class="text-sm text-slate-400">Target Valuation</div>
                                    <div class="text-2xl font-bold text-cyan-400">$${gameState.targetValuation}M</div>
                                </div>
                            </div>

                            <div class="relative w-full h-3 bg-slate-900/50 rounded-full overflow-hidden border border-blue-500/20">
                                <div class="progress-bar absolute h-full" style="width: ${progressPercent}%"></div>
                            </div>
                            <div class="flex justify-between mt-2 text-sm text-slate-400">
                                <span>$${gameState.valuation}M</span>
                                <span>${Math.floor(progressPercent)}% to goal</span>
                            </div>
                        </div>

                        <!-- KPI Dashboard -->
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6">
                            <div class="glass border border-green-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-green-400 text-xl">üí∞</span>
                                    <span class="text-slate-400 text-sm">Cash</span>
                                </div>
                                <div class="text-2xl font-bold text-green-400">$${gameState.cash}M</div>
                            </div>

                            <div class="glass border border-blue-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-blue-400 text-xl">üìà</span>
                                    <span class="text-slate-400 text-sm">Valuation</span>
                                </div>
                                <div class="text-2xl font-bold text-blue-400">$${gameState.valuation}M</div>
                            </div>

                            <div class="glass border border-purple-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-purple-400 text-xl">üë•</span>
                                    <span class="text-slate-400 text-sm">Talent</span>
                                </div>
                                <div class="text-2xl font-bold text-purple-400">${gameState.talent}</div>
                                <div class="w-full h-1.5 bg-slate-900/50 rounded-full mt-2">
                                    <div class="h-full bg-purple-500 rounded-full" style="width: ${gameState.talent}%"></div>
                                </div>
                            </div>

                            <div class="glass border border-cyan-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-cyan-400 text-xl">üèÜ</span>
                                    <span class="text-slate-400 text-sm">Reputation</span>
                                </div>
                                <div class="text-2xl font-bold text-cyan-400">${gameState.reputation}</div>
                                <div class="w-full h-1.5 bg-slate-900/50 rounded-full mt-2">
                                    <div class="h-full bg-cyan-500 rounded-full" style="width: ${gameState.reputation}%"></div>
                                </div>
                            </div>

                            <div class="glass border border-yellow-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-xl">üèõÔ∏è</span>
                                    <span class="text-slate-400 text-sm">Gov Relations</span>
                                </div>
                                <div class="text-2xl font-bold text-yellow-400">${gameState.govRelations}</div>
                                <div class="w-full h-1.5 bg-slate-900/50 rounded-full mt-2">
                                    <div class="h-full bg-yellow-500 rounded-full" style="width: ${gameState.govRelations}%"></div>
                                </div>
                            </div>

                            <div class="glass border border-pink-500/30 rounded-lg p-4 shadow-lg">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="text-xl">üî¨</span>
                                    <span class="text-slate-400 text-sm">Innovation</span>
                                </div>
                                <div class="text-2xl font-bold text-pink-400">${gameState.innovation}</div>
                                <div class="w-full h-1.5 bg-slate-900/50 rounded-full mt-2">
                                    <div class="h-full bg-pink-500 rounded-full" style="width: ${gameState.innovation}%"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Active Contracts -->
                        <div class="glass border border-blue-500/30 rounded-lg p-4 mb-6 shadow-lg">
                            <div class="text-sm text-slate-400">Active Contracts: <span class="text-cyan-400 font-bold">${gameState.contracts}</span> ($${gameState.contracts * 3}M revenue per quarter)</div>
                        </div>

                        <!-- Scenario Card -->
                        ${gameState.currentScenario ? `
                            <div class="glass border border-blue-500/40 rounded-lg p-8 shadow-2xl">
                                <div class="text-center mb-6">
                                    <div class="text-6xl mb-4">${gameState.currentScenario.icon}</div>
                                    <h2 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-3">
                                        ${gameState.currentScenario.title}
                                    </h2>
                                    <p class="text-slate-300 text-lg max-w-2xl mx-auto">
                                        ${gameState.currentScenario.description}
                                    </p>
                                </div>

                                <div class="space-y-4">
                                    ${gameState.currentScenario.options.map((option, index) => `
                                        <button
                                            onclick="makeDecision(${index})"
                                            class="w-full bg-slate-900/50 hover:bg-slate-800/70 border border-blue-500/30 hover:border-cyan-400/60 rounded-lg p-6 text-left transition-all shadow-lg hover:shadow-cyan-500/30 group"
                                        >
                                            <div class="text-lg font-semibold text-blue-300 group-hover:text-cyan-300 mb-2 transition-colors">
                                                ${option.text}
                                            </div>
                                            <div class="text-slate-400 text-sm flex flex-wrap gap-3">
                                                ${option.effects.cash ? `<span class="${option.effects.cash > 0 ? 'text-green-400' : 'text-red-400'}">Cash: ${option.effects.cash > 0 ? '+' : ''}${option.effects.cash}M</span>` : ''}
                                                ${option.effects.valuation ? `<span class="${option.effects.valuation > 0 ? 'text-green-400' : 'text-red-400'}">Valuation: ${option.effects.valuation > 0 ? '+' : ''}${option.effects.valuation}M</span>` : ''}
                                                ${option.effects.reputation ? `<span class="${option.effects.reputation > 0 ? 'text-green-400' : 'text-red-400'}">Reputation: ${option.effects.reputation > 0 ? '+' : ''}${option.effects.reputation}</span>` : ''}
                                                ${option.effects.talent ? `<span class="${option.effects.talent > 0 ? 'text-green-400' : 'text-red-400'}">Talent: ${option.effects.talent > 0 ? '+' : ''}${option.effects.talent}</span>` : ''}
                                                ${option.effects.govRelations ? `<span class="${option.effects.govRelations > 0 ? 'text-green-400' : 'text-red-400'}">Gov Relations: ${option.effects.govRelations > 0 ? '+' : ''}${option.effects.govRelations}</span>` : ''}
                                                ${option.effects.innovation ? `<span class="${option.effects.innovation > 0 ? 'text-green-400' : 'text-red-400'}">Innovation: ${option.effects.innovation > 0 ? '+' : ''}${option.effects.innovation}</span>` : ''}
                                                ${option.effects.contracts ? `<span class="${option.effects.contracts > 0 ? 'text-green-400' : 'text-red-400'}">Contracts: ${option.effects.contracts > 0 ? '+' : ''}${option.effects.contracts}</span>` : ''}
                                            </div>
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function selectStrategy(strategyKey) {
            gameState.strategy = strategyKey;
            document.querySelectorAll('.strategy-btn').forEach(btn => {
                btn.classList.remove('border-cyan-400', 'bg-cyan-900/30');
                btn.classList.add('border-blue-500/30');
            });
            document.getElementById(`strategy-${strategyKey}`).classList.remove('border-blue-500/30');
            document.getElementById(`strategy-${strategyKey}`).classList.add('border-cyan-400', 'bg-cyan-900/30');
            checkStartReady();
        }

        function selectAdvisor(role, type) {
            gameState.advisors[role] = type;
            document.querySelectorAll(`.advisor-btn[id^="advisor-${role}-"]`).forEach(btn => {
                btn.classList.remove('border-cyan-400', 'bg-cyan-900/30');
                btn.classList.add('border-blue-500/30');
            });
            document.getElementById(`advisor-${role}-${type}`).classList.remove('border-blue-500/30');
            document.getElementById(`advisor-${role}-${type}`).classList.add('border-cyan-400', 'bg-cyan-900/30');
            checkStartReady();
        }

        function checkStartReady() {
            const input = document.getElementById('companyNameInput');
            const button = document.getElementById('startButton');
            const error = document.getElementById('startError');
            
            const ready = input && input.value.trim() && 
                         gameState.strategy && 
                         gameState.advisors.cfo && 
                         gameState.advisors.cto && 
                         gameState.advisors.lobbyist;
            
            if (button) {
                button.disabled = !ready;
            }
            if (error) {
                error.classList.toggle('hidden', ready);
            }
        }

        function startGame() {
            const input = document.getElementById('companyNameInput');
            const name = input ? input.value.trim() : '';
            if (name && gameState.strategy && gameState.advisors.cfo && gameState.advisors.cto && gameState.advisors.lobbyist) {
                gameState.companyName = name;
                gameState.gameStarted = true;
                const strategyName = strategies[gameState.strategy].name;
                gameState.eventLog.push(`${name} founded with ${strategyName} strategy.`);
                gameState.eventLog.push(`Target: ${gameState.targetValuation}M valuation in ${gameState.maxQuarters} quarters.`);
                gameState.eventLog.push(`Advisory Team: ${advisorTypes.cfo[gameState.advisors.cfo].name} (CFO), ${advisorTypes.cto[gameState.advisors.cto].name} (CTO), ${advisorTypes.lobbyist[gameState.advisors.lobbyist].name} (Gov Relations)`);
                presentNewScenario();
                render();
            }
        }

        function presentNewScenario() {
            const availableScenarios = scenarios.filter(s => 
                !gameState.eventLog.some(log => log.includes(s.title))
            );
            
            const scenario = availableScenarios.length > 0 
                ? availableScenarios[Math.floor(Math.random() * availableScenarios.length)]
                : scenarios[Math.floor(Math.random() * scenarios.length)];
            
            gameState.currentScenario = scenario;
        }

        function makeDecision(optionIndex) {
            const option = gameState.currentScenario.options[optionIndex];
            let effects = {...option.effects};
            let outcome = option.outcome;

            // Apply strategy modifiers
            const strategy = strategies[gameState.strategy];
            if (effects.valuation) {
                effects.valuation = Math.floor(effects.valuation * strategy.effects.valuationMultiplier);
            }
            if (effects.cash && effects.cash < 0) {
                effects.cash = Math.floor(effects.cash * strategy.effects.cashPenalty);
            }

            // Check for random failure (modified by strategy)
            const adjustedFailureChance = (option.failureChance || 0) * strategy.effects.riskMultiplier;
            if (option.failureChance && Math.random() < adjustedFailureChance) {
                effects = {...option.failureEffects};
                outcome = option.failureOutcome;
                // Apply strategy modifiers to failure effects too
                if (effects.valuation) {
                    effects.valuation = Math.floor(effects.valuation * strategy.effects.valuationMultiplier);
                }
            }

            // Apply effects
            gameState.valuation = Math.max(0, gameState.valuation + (effects.valuation || 0));
            gameState.cash = Math.max(0, gameState.cash + (effects.cash || 0));
            gameState.reputation = Math.max(0, Math.min(100, gameState.reputation + (effects.reputation || 0)));
            gameState.talent = Math.max(0, Math.min(100, gameState.talent + (effects.talent || 0)));
            gameState.govRelations = Math.max(0, Math.min(100, gameState.govRelations + (effects.govRelations || 0)));
            gameState.contracts = Math.max(0, gameState.contracts + (effects.contracts || 0));
            gameState.innovation = Math.max(0, Math.min(100, gameState.innovation + (effects.innovation || 0)));

            // Add quarterly revenue from contracts
            const quarterlyRevenue = gameState.contracts * 3;
            gameState.cash += quarterlyRevenue;

            // Natural valuation growth based on performance
            const performanceMultiplier = (gameState.reputation + gameState.talent + gameState.govRelations + gameState.innovation) / 400;
            gameState.valuation += Math.floor(gameState.valuation * 0.05 * performanceMultiplier);

            // Random event chance (15% each quarter)
            let randomEventOccurred = false;
            if (Math.random() < 0.15) {
                const randomEvent = randomEvents[Math.floor(Math.random() * randomEvents.length)];
                gameState.valuation = Math.max(0, gameState.valuation + (randomEvent.effects.valuation || 0));
                gameState.cash = Math.max(0, gameState.cash + (randomEvent.effects.cash || 0));
                gameState.reputation = Math.max(0, Math.min(100, gameState.reputation + (randomEvent.effects.reputation || 0)));
                gameState.talent = Math.max(0, Math.min(100, gameState.talent + (randomEvent.effects.talent || 0)));
                gameState.govRelations = Math.max(0, Math.min(100, gameState.govRelations + (randomEvent.effects.govRelations || 0)));
                gameState.contracts = Math.max(0, gameState.contracts + (randomEvent.effects.contracts || 0));
                gameState.innovation = Math.max(0, Math.min(100, gameState.innovation + (randomEvent.effects.innovation || 0)));
                
                gameState.eventLog.push(`${randomEvent.icon} RANDOM EVENT: ${randomEvent.title}`);
                gameState.eventLog.push(`‚Üí ${randomEvent.description}`);
                randomEventOccurred = true;
            }

            // Log the event
            gameState.eventLog.push(`Q${gameState.quarter}: ${gameState.currentScenario.title} - ${option.text}`);
            gameState.eventLog.push(`‚Üí ${outcome}`);

            // Advance quarter
            gameState.quarter += 1;
            gameState.currentScenario = null;

            // Check win/loss conditions
            if (gameState.valuation >= gameState.targetValuation) {
                gameState.gameOver = true;
                gameState.victory = true;
                gameState.eventLog.push(`üéâ VICTORY! You've reached ${gameState.valuation}M valuation!`);
            } else if (gameState.quarter > gameState.maxQuarters) {
                gameState.gameOver = true;
                gameState.victory = false;
                gameState.eventLog.push(`‚è∞ Time's up! Final valuation: ${gameState.valuation}M (Target: ${gameState.targetValuation}M)`);
            } else if (gameState.cash <= 0) {
                gameState.gameOver = true;
                gameState.victory = false;
                gameState.eventLog.push(`üí∏ Bankruptcy! You've run out of cash.`);
            } else if (gameState.reputation < gameState.minReputation) {
                gameState.gameOver = true;
                gameState.victory = false;
                gameState.eventLog.push(`üìâ Reputation collapse! Your reputation has fallen below ${gameState.minReputation}. No serious clients will work with you.`);
            } else if (gameState.talent < gameState.minTalent) {
                gameState.gameOver = true;
                gameState.victory = false;
                gameState.eventLog.push(`üë• Talent exodus! Your talent pool has dropped below ${gameState.minTalent}. You can't execute contracts.`);
            } else if (gameState.govRelations < gameState.minGovRelations) {
                gameState.gameOver = true;
                gameState.victory = false;
                gameState.eventLog.push(`üèõÔ∏è Government relations destroyed! Your standing has fallen below ${gameState.minGovRelations}. You're effectively blacklisted.`);
            }

            if (!gameState.gameOver) {
                presentNewScenario();
            }
            
            render();
        }

        function resetGame() {
            gameState.companyName = '';
            gameState.quarter = 1;
            gameState.valuation = 50;
            gameState.targetValuation = 750;
            gameState.cash = 18;
            gameState.reputation = 70;
            gameState.talent = 60;
            gameState.govRelations = 50;
            gameState.contracts = 2;
            gameState.innovation = 50;
            gameState.gameStarted = false;
            gameState.gameOver = false;
            gameState.victory = false;
            gameState.currentScenario = null;
            gameState.eventLog = [];
            gameState.minReputation = 25;
            gameState.minTalent = 25;
            gameState.minGovRelations = 20;
            gameState.strategy = null;
            gameState.advisors = {
                cfo: null,
                cto: null,
                lobbyist: null
            };
            render();
        }

        // Initial render
        render();
    </script>
</body>
</html>
