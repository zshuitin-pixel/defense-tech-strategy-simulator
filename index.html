<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanguard Defense: Strategic Planning Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
        }
        .game-container {
            background-color: #1e293b;
            border: 2px solid #334155;
            border-radius: 1rem;
            box-shadow: 0 0 40px rgba(59, 130, 246, 0.3);
            width: 100%;
            max-width: 1400px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 95vh;
        }
        .header {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            padding: 1.5rem;
            border-bottom: 2px solid #334155;
            text-align: center;
        }
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #f0f9ff;
            margin: 0 0 0.5rem 0;
        }
        .action-points-display {
            background-color: rgba(251, 191, 36, 0.2);
            border: 2px solid #fbbf24;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            display: inline-block;
            margin-top: 0.5rem;
        }
        .action-points-display strong {
            color: #fbbf24;
            font-size: 1.2rem;
        }
        .main-content {
            display: flex;
            flex-grow: 1;
            padding: 1rem;
            gap: 1rem;
            overflow: hidden;
        }
        .left-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            overflow-y: auto;
        }
        .status-panel {
            background-color: #0f172a;
            border: 1px solid #334155;
            border-radius: 0.75rem;
            padding: 1.25rem;
        }
        .status-panel h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: #60a5fa;
            margin: 0 0 1rem 0;
            text-align: center;
            border-bottom: 2px solid #334155;
            padding-bottom: 0.5rem;
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.7rem;
            padding: 0.5rem;
            background-color: #1e293b;
            border-radius: 0.5rem;
            border-left: 3px solid #3b82f6;
        }
        .status-label {
            color: #94a3b8;
            font-size: 0.9rem;
        }
        .status-value {
            font-weight: 700;
            color: #e0f2fe;
            font-size: 0.95rem;
        }
        .change-indicator {
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }
        .change-positive { color: #4ade80; }
        .change-negative { color: #f87171; }
        .products-panel {
            background-color: #0f172a;
            border: 1px solid #334155;
            border-radius: 0.75rem;
            padding: 1rem;
        }
        .products-panel h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: #60a5fa;
            margin: 0 0 0.75rem 0;
            text-align: center;
        }
        .product-item {
            margin-bottom: 1rem;
            padding: 0.75rem;
            background-color: #1e293b;
            border-radius: 0.5rem;
        }
        .product-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: #bfdbfe;
            margin-bottom: 0.5rem;
        }
        .product-milestone {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-top: 0.3rem;
        }
        .milestone-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            margin-top: 0.2rem;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #334155;
            border-radius: 4px;
            overflow: hidden;
            margin: 0.5rem 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            transition: width 0.3s ease;
        }
        .center-panel {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .log-panel {
            flex: 1;
            background-color: #0f172a;
            border: 1px solid #334155;
            border-radius: 0.75rem;
            padding: 1rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column-reverse;
        }
        .log-message {
            margin-bottom: 0.6rem;
            padding: 0.6rem;
            border-radius: 0.4rem;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        .log-message.system { 
            color: #60a5fa; 
            background-color: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
        }
        .log-message.error { 
            color: #f87171; 
            background-color: rgba(248, 113, 113, 0.1);
            border-left: 3px solid #ef4444;
        }
        .log-message.player { 
            color: #84cc16; 
            background-color: rgba(132, 204, 22, 0.1);
            border-left: 3px solid #84cc16;
        }
        .log-message.success { 
            color: #4ade80; 
            background-color: rgba(74, 222, 128, 0.1);
            border-left: 3px solid #22c55e;
        }
        .log-message.warning { 
            color: #fbbf24; 
            background-color: rgba(251, 191, 36, 0.1);
            border-left: 3px solid #f59e0b;
        }
        .log-message.impact {
            color: #c084fc;
            background-color: rgba(192, 132, 252, 0.15);
            border-left: 3px solid #a855f7;
            font-weight: 500;
        }
        .command-panel {
            background-color: #1e293b;
            padding: 1rem;
            border-top: 2px solid #334155;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 0.6rem;
        }
        .action-button {
            padding: 0.75rem 0.5rem;
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
            border: none;
            border-radius: 0.5rem;
            color: white;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            text-align: center;
            position: relative;
        }
        .action-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #1d4ed8 0%, #2563eb 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(59, 130, 246, 0.4);
        }
        .action-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: linear-gradient(135deg, #475569 0%, #64748b 100%);
        }
        .action-cost {
            display: block;
            font-size: 0.7rem;
            opacity: 0.8;
            margin-top: 0.2rem;
        }
        .action-button.critical {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
        }
        .action-button.critical:hover:not(:disabled) {
            background: linear-gradient(135deg, #b91c1c 0%, #dc2626 100%);
        }
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #1e293b;
            border: 1px solid #60a5fa;
            padding: 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            white-space: nowrap;
            margin-bottom: 0.5rem;
            display: none;
            z-index: 100;
        }
        .action-button:hover .tooltip {
            display: block;
        }

        @media (max-width: 1024px) {
            .game-container {
                height: auto;
                max-height: none;
            }
            .main-content {
                flex-direction: column;
                overflow-y: auto;
                padding: 0.5rem;
                gap: 0.75rem;
            }
            .left-panel {
                flex: none;
                gap: 0.75rem;
                overflow-y: visible;
            }
            .center-panel {
                min-height: 40vh;
                gap: 0.75rem;
            }
            .header h1 {
                font-size: 1.5rem;
            }
            .status-panel, .products-panel, .log-panel {
                padding: 0.75rem;
            }
            .button-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            .action-button {
                padding: 0.6rem 0.4rem;
                font-size: 0.75rem;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.2rem;
            }
            .action-button {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ğŸ›¡ï¸ Vanguard Defense Technologies</h1>
            <div class="action-points-display">
                <strong><span id="actionPoints">3</span> / 3</strong> Action Points Remaining
            </div>
        </div>
        <div class="main-content">
            <div class="left-panel">
                <div class="status-panel">
                    <h3>Company Status (Q<span id="statusQuarter">1</span> <span id="statusYear">2025</span>)</h3>
                    <div class="status-item">
                        <span class="status-label">ğŸ’° Cash:</span>
                        <span id="statusCash" class="status-value">$0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">â³ Runway:</span>
                        <span id="statusRunway" class="status-value">0 mo</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ“ˆ Valuation:</span>
                        <span id="statusValuation" class="status-value">$0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ’µ Revenue/mo:</span>
                        <span id="statusRevenue" class="status-value">$0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ”¥ Burn/mo:</span>
                        <span id="statusBurn" class="status-value">$0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ‘¥ Team:</span>
                        <span id="statusTeam" class="status-value">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ˜Š Morale:</span>
                        <span id="statusMorale" class="status-value">0%</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">â­ Reputation:</span>
                        <span id="statusReputation" class="status-value">0%</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ğŸ›ï¸ DoD Relations:</span>
                        <span id="statusDoD" class="status-value">0%</span>
                    </div>
                </div>

                <div class="products-panel">
                    <h3>ğŸ“¦ Product Development</h3>
                    <div id="productsContainer"></div>
                </div>
            </div>

            <div class="center-panel">
                <div class="log-panel" id="logPanel"></div>
            </div>
        </div>
        <div class="command-panel">
            <div class="button-grid">
                <button id="btnHire" class="action-button" onclick="processAction('hire')">
                    Hire Team
                    <span class="action-cost">Cost: $200K, 1 AP</span>
                    <div class="tooltip">+5 people, +$50K burn, +morale, faster dev</div>
                </button>
                <button id="btnRaise" class="action-button" onclick="processAction('raise')">
                    Raise Funding
                    <span class="action-cost">1 AP</span>
                    <div class="tooltip">Raise next round, dilution increases</div>
                </button>
                <button id="btnDevAI" class="action-button" onclick="processAction('dev_ai')">
                    Develop AI
                    <span class="action-cost">1 AP</span>
                    <div class="tooltip">+20% progress on AI Surveillance</div>
                </button>
                <button id="btnDevDrone" class="action-button" onclick="processAction('dev_drone')">
                    Develop Drones
                    <span class="action-cost">Cost: $300K, 1 AP</span>
                    <div class="tooltip">Start/progress Autonomous Drones</div>
                </button>
                <button id="btnContract" class="action-button" onclick="processAction('contract')">
                    Bid Contract
                    <span class="action-cost">Cost: $100K, 1 AP</span>
                    <div class="tooltip">Req: 50% DoD, deployed product</div>
                </button>
                <button id="btnMarketing" class="action-button" onclick="processAction('marketing')">
                    Marketing
                    <span class="action-cost">Cost: $150K, 1 AP</span>
                    <div class="tooltip">+reputation, +DoD relations</div>
                </button>
                <button id="btnOptimize" class="action-button" onclick="processAction('optimize')">
                    Cut Costs
                    <span class="action-cost">1 AP</span>
                    <div class="tooltip">-15% burn, -morale</div>
                </button>
                <button class="action-button" onclick="showReport()">
                    View Report
                    <span class="action-cost">Free</span>
                </button>
                <button id="btnAdvance" class="action-button critical" onclick="advanceQuarter()">
                    End Quarter â­ï¸
                    <span class="action-cost">Advances time</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        const gameState = {
            quarter: 1,
            year: 2025,
            cash: 2000000,
            valuation: 15000000,
            employees: 12,
            morale: 70,
            reputation: 40,
            dodRelations: 35,
            burnRate: 250000,
            revenue: 0,
            actionPoints: 3,
            maxActionPoints: 3,
            products: {
                aiSurveillance: { 
                    name: 'AI Surveillance', 
                    progress: 25, 
                    deployed: false, 
                    revenue: 100000,
                    milestones: [
                        {threshold: 60, label: 'Can demo to DoD', unlocked: false},
                        {threshold: 80, label: 'Can bid contracts', unlocked: false},
                        {threshold: 100, label: 'Deploy & earn revenue', unlocked: false}
                    ]
                },
                autonomousDrone: { 
                    name: 'Autonomous Drones', 
                    progress: 0, 
                    deployed: false, 
                    revenue: 150000,
                    milestones: [
                        {threshold: 60, label: 'Can demo', unlocked: false},
                        {threshold: 100, label: 'Deploy & earn revenue', unlocked: false}
                    ]
                }
            },
            lastChanges: {},
            contracts: [],
            gameOver: false,
            fundingRound: 'Seed',
            competitorThreat: 50
        };

        const logPanel = document.getElementById('logPanel');

        function logMessage(message, type) {
            type = type || 'system';
            const msgElement = document.createElement('div');
            msgElement.classList.add('log-message', type);
            msgElement.innerHTML = '[Q' + gameState.quarter + '] ' + message;
            logPanel.prepend(msgElement);
            while (logPanel.children.length > 40) {
                logPanel.removeChild(logPanel.lastChild);
            }
        }

        function trackChange(metric, oldVal, newVal) {
            const diff = newVal - oldVal;
            if (diff !== 0) {
                gameState.lastChanges[metric] = diff;
            }
        }

        function showChangeIndicator(metric) {
            const change = gameState.lastChanges[metric];
            if (!change) return '';
            const className = change > 0 ? 'change-positive' : 'change-negative';
            const symbol = change > 0 ? '+' : '';
            return '<span class="change-indicator ' + className + '">' + symbol + change.toFixed(0) + '</span>';
        }

        function updateDisplay() {
            document.getElementById('statusQuarter').textContent = gameState.quarter;
            document.getElementById('statusYear').textContent = gameState.year;
            document.getElementById('actionPoints').textContent = gameState.actionPoints;
            
            document.getElementById('statusCash').innerHTML = '$' + (gameState.cash / 1000000).toFixed(2) + 'M' + showChangeIndicator('cash');
            
            const runway = Math.max(0, Math.floor(gameState.cash / gameState.burnRate));
            const runwayEl = document.getElementById('statusRunway');
            runwayEl.innerHTML = runway + ' mo' + showChangeIndicator('runway');
            runwayEl.style.color = runway >= 8 ? '#4ade80' : runway >= 4 ? '#fbbf24' : '#f87171';
            
            document.getElementById('statusValuation').innerHTML = '$' + (gameState.valuation / 1000000).toFixed(1) + 'M';
            document.getElementById('statusRevenue').innerHTML = '$' + (gameState.revenue / 1000).toFixed(0) + 'K' + showChangeIndicator('revenue');
            document.getElementById('statusBurn').innerHTML = '$' + (gameState.burnRate / 1000).toFixed(0) + 'K' + showChangeIndicator('burn');
            document.getElementById('statusTeam').innerHTML = gameState.employees + showChangeIndicator('team');
            document.getElementById('statusMorale').innerHTML = Math.round(gameState.morale) + '%' + showChangeIndicator('morale');
            document.getElementById('statusReputation').innerHTML = Math.round(gameState.reputation) + '%' + showChangeIndicator('reputation');
            document.getElementById('statusDoD').innerHTML = Math.round(gameState.dodRelations) + '%' + showChangeIndicator('dod');
            
            updateProductsDisplay();
            updateButtonStates();
        }

        function updateProductsDisplay() {
            const container = document.getElementById('productsContainer');
            container.innerHTML = '';
            
            Object.keys(gameState.products).forEach(function(key) {
                const product = gameState.products[key];
                const productDiv = document.createElement('div');
                productDiv.className = 'product-item';
                
                var html = '<div class="product-name">' + product.name + ': ' + product.progress + '% ' + (product.deployed ? 'âœ…' : '') + '</div>';
                html += '<div class="progress-bar"><div class="progress-fill" style="width: ' + product.progress + '%"></div></div>';
                
                product.milestones.forEach(function(milestone) {
                    const reached = product.progress >= milestone.threshold;
                    const icon = reached ? 'âœ…' : 'ğŸ”’';
                    const style = reached ? 'color: #4ade80;' : 'color: #64748b;';
                    html += '<div class="milestone-item" style="' + style + '">' + icon + ' ' + milestone.threshold + '%: ' + milestone.label + '</div>';
                });
                
                productDiv.innerHTML = html;
                container.appendChild(productDiv);
            });
        }

        function updateButtonStates() {
            const noAP = gameState.actionPoints <= 0;
            
            document.getElementById('btnHire').disabled = noAP || gameState.cash < 200000;
            document.getElementById('btnRaise').disabled = noAP;
            document.getElementById('btnDevAI').disabled = noAP || gameState.products.aiSurveillance.progress >= 100;
            document.getElementById('btnDevDrone').disabled = noAP || gameState.cash < 300000;
            
            const hasDeployedProduct = Object.values(gameState.products).some(function(p) { return p.deployed; });
            document.getElementById('btnContract').disabled = noAP || gameState.cash < 100000 || gameState.dodRelations < 50 || !hasDeployedProduct;
            
            document.getElementById('btnMarketing').disabled = noAP || gameState.cash < 150000;
            document.getElementById('btnOptimize').disabled = noAP;
        }

        function spendActionPoint() {
            if (gameState.actionPoints <= 0) return false;
            gameState.actionPoints--;
            return true;
        }

        function showImpact(action, immediate, consequence) {
            logMessage('ğŸ“Š <strong>IMPACT:</strong> ' + immediate, 'impact');
            if (consequence) {
                logMessage('âš¡ <strong>CONSEQUENCE:</strong> ' + consequence, 'impact');
            }
        }

        function processAction(action) {
            if (gameState.actionPoints <= 0) {
                logMessage('âŒ No action points left! End quarter to continue.', 'error');
                return;
            }
            
            gameState.lastChanges = {};
            
            switch(action) {
                case 'hire':
                    if (gameState.cash < 200000) {
                        logMessage('âŒ Insufficient funds ($200K required)', 'error');
                        return;
                    }
                    if (!spendActionPoint()) return;
                    
                    const oldTeam = gameState.employees;
                    const oldBurn = gameState.burnRate;
                    const oldMorale = gameState.morale;
                    
                    gameState.cash -= 200000;
                    gameState.employees += 5;
                    gameState.burnRate += 50000;
                    gameState.morale = Math.min(100, gameState.morale + 10);
                    
                    trackChange('team', oldTeam, gameState.employees);
                    trackChange('burn', oldBurn / 1000, gameState.burnRate / 1000);
                    trackChange('morale', oldMorale, gameState.morale);
                    
                    logMessage('> Hired 5 engineers', 'player');
                    showImpact('Team grows stronger', 'Team: ' + oldTeam + 'â†’' + gameState.employees + ', Burn: +$50K/mo, Morale: +10%', 
                               'All products will develop 25% faster next quarter');
                    break;
                    
                case 'raise':
                    if (!spendActionPoint()) return;
                    
                    var funding, newRound, dilution;
                    if (gameState.fundingRound === 'Seed') {
                        funding = 5000000;
                        newRound = 'Series A';
                        dilution = 20;
                    } else if (gameState.fundingRound === 'Series A') {
                        funding = 15000000;
                        newRound = 'Series B';
                        dilution = 15;
                    } else {
                        funding = 30000000;
                        newRound = 'Series C';
                        dilution = 12;
                    }
                    
                    const oldCash = gameState.cash;
                    gameState.cash += funding;
                    gameState.valuation = Math.floor(gameState.valuation * 1.6);
                    gameState.fundingRound = newRound;
                    
                    trackChange('cash', oldCash / 1000000, gameState.cash / 1000000);
                    
                    logMessage('> Raised ' + newRound, 'player');
                    showImpact('Funding secured', '+$' + (funding/1000000) + 'M cash, Valuation: $' + (gameState.valuation/1000000).toFixed(1) + 'M',
                               'You gave up ' + dilution + '% equity. Investors expect faster growth now.');
                    break;
                    
                case 'dev_ai':
                    if (!spendActionPoint()) return;
                    
                    const oldProgress = gameState.products.aiSurveillance.progress;
                    const boost = gameState.employees >= 15 ? 25 : 20;
                    gameState.products.aiSurveillance.progress = Math.min(100, oldProgress + boost);
                    
                    logMessage('> Focused on AI development', 'player');
                    
                    var consequence = 'Drone development will be slower while focusing on AI';
                    gameState.products.aiSurveillance.milestones.forEach(function(m) {
                        if (!m.unlocked && gameState.products.aiSurveillance.progress >= m.threshold) {
                            m.unlocked = true;
                            consequence = 'ğŸ‰ UNLOCKED: ' + m.label + '!';
                        }
                    });
                    
                    showImpact('AI development accelerated', 'Progress: ' + oldProgress + '%â†’' + gameState.products.aiSurveillance.progress + '%', consequence);
                    break;
                    
                case 'dev_drone':
                    if (gameState.cash < 300000) {
                        logMessage('âŒ Insufficient funds ($300K required)', 'error');
                        return;
                    }
                    if (!spendActionPoint()) return;
                    
                    gameState.cash -= 300000;
                    const oldDroneProgress = gameState.products.autonomousDrone.progress;
                    gameState.products.autonomousDrone.progress = Math.min(100, Math.max(oldDroneProgress, 20) + 15);
                    
                    logMessage('> Invested in drone technology', 'player');
                    showImpact('Drone program progressing', 'Progress: ' + oldDroneProgress + '%â†’' + gameState.products.autonomousDrone.progress + '%',
                               'This is a risky bet - drones are harder than AI but higher reward');
                    break;
                    
                case 'contract':
                    if (gameState.cash < 100000) {
                        logMessage('âŒ Insufficient funds ($100K required)', 'error');
                        return;
                    }
                    const hasDeployed = Object.values(gameState.products).some(function(p) { return p.deployed; });
                    if (!hasDeployed) {
                        logMessage('âŒ Need a deployed product to bid contracts', 'error');
                        return;
                    }
                    if (gameState.dodRelations < 50) {
                        logMessage('âŒ DoD relations too low (need 50%)', 'error');
                        return;
                    }
                    if (!spendActionPoint()) return;
                    
                    gameState.cash -= 100000;
                    const winChance = (gameState.dodRelations * 0.6) + (gameState.reputation * 0.4);
                    
                    logMessage('> Bid on DoD contract', 'player');
                    logMessage('ğŸ“Š Win chance: ' + winChance.toFixed(0) + '% = (DoD ' + gameState.dodRelations.toFixed(0) + '% Ã— 0.6) + (Rep ' + gameState.reputation.toFixed(0) + '% Ã— 0.4)', 'system');
                    
                    if (Math.random() * 100 < winChance) {
                        const contractValue = Math.floor(Math.random() * 1000000) + 1500000;
                        gameState.contracts.push({value: contractValue, quarter: gameState.quarter});
                        const oldRevenue = gameState.revenue;
                        gameState.revenue += Math.floor(contractValue / 6);
                        gameState.reputation = Math.min(100, gameState.reputation + 15);
                        gameState.dodRelations = Math.min(100, gameState.dodRelations + 10);
                        gameState.valuation = Math.floor(gameState.valuation * 1.2);
                        
                        trackChange('revenue', oldRevenue / 1000, gameState.revenue / 1000);
                        
                        showImpact('CONTRACT WON!', 'Value: $' + (contractValue/1000000).toFixed(1) + 'M, Revenue: +$' + (contractValue/6000).toFixed(0) + 'K/mo',
                                   'This validates your product and opens doors to bigger contracts');
                    } else {
                        const oldRep = gameState.reputation;
                        gameState.reputation = Math.max(0, gameState.reputation - 5);
                        trackChange('reputation', oldRep, gameState.reputation);
                        showImpact('Contract bid FAILED', 'Lost $100K in pursuit costs',
                                   'Reputation dinged. Build stronger DoD relations before next bid.');
                    }
                    break;
                    
                case 'marketing':
                    if (gameState.cash < 150000) {
                        logMessage('âŒ Insufficient funds ($150K required)', 'error');
                        return;
                    }
                    if (!spendActionPoint()) return;
                    
                    gameState.cash -= 150000;
                    const oldRep = gameState.reputation;
                    const oldDoD = gameState.dodRelations;
                    gameState.reputation = Math.min(100, gameState.reputation + 12);
                    gameState.dodRelations = Math.min(100, gameState.dodRelations + 8);
                    
                    trackChange('reputation', oldRep, gameState.reputation);
                    trackChange('dod', oldDoD, gameState.dodRelations);
                    
                    logMessage('> Launched marketing campaign', 'player');
                    showImpact('Brand visibility increased', 'Reputation: +12%, DoD relations: +8%',
                               'Better positioning for next contract bid or partnership');
                    break;
                    
                case 'optimize':
                    if (!spendActionPoint()) return;
                    
                    const oldBurnOpt = gameState.burnRate;
                    const oldMoraleOpt = gameState.morale;
                    gameState.burnRate = Math.max(200000, Math.floor(gameState.burnRate * 0.85));
                    gameState.morale = Math.max(0, gameState.morale - 15);
                    
                    trackChange('burn', oldBurnOpt / 1000, gameState.burnRate / 1000);
                    trackChange('morale', oldMoraleOpt, gameState.morale);
                    
                    logMessage('> Optimized operations', 'player');
                    showImpact('Costs reduced', 'Burn: -15%, Morale: -15%',
                               'Team unhappy about cuts. May slow development or cause turnover.');
                    break;
            }
            
            updateDisplay();
        }

        function advanceQuarter() {
            logMessage('â”â”â” END Q' + gameState.quarter + ' ' + gameState.year + ' â”â”â”', 'system');
            
            gameState.lastChanges = {};
            const oldCash = gameState.cash;
            const oldMorale = gameState.morale;
            const oldRunway = Math.floor(gameState.cash / gameState.burnRate);
            
            gameState.cash += (gameState.revenue - gameState.burnRate);
            
            trackChange('cash', oldCash / 1000000, gameState.cash / 1000000);
            const newRunway = Math.max(0, Math.floor(gameState.cash / gameState.burnRate));
            trackChange('runway', oldRunway, newRunway);
            
            logMessage('ğŸ’° Revenue: +$' + (gameState.revenue/1000).toFixed(0) + 'K | Burn: -$' + (gameState.burnRate/1000).toFixed(0) + 'K | Net: ' + ((gameState.revenue - gameState.burnRate) >= 0 ? '+' : '') + '$' + ((gameState.revenue - gameState.burnRate)/1000).toFixed(0) + 'K', 'system');
            
            const teamBoost = gameState.employees >= 15 ? 1.25 : 1.0;
            Object.keys(gameState.products).forEach(function(key) {
                const p = gameState.products[key];
                if (p.progress > 0 && p.progress < 100 && !p.deployed) {
                    const oldProg = p.progress;
                    p.progress = Math.min(100, p.progress + (8 * teamBoost));
                    
                    if (p.progress >= 100 && !p.deployed) {
                        p.deployed = true;
                        const oldRev = gameState.revenue;
                        gameState.revenue += p.revenue;
                        gameState.reputation += 20;
                        gameState.valuation = Math.floor(gameState.valuation * 1.25);
                        trackChange('revenue', oldRev / 1000, gameState.revenue / 1000);
                        logMessage('ğŸš€ ' + p.name + ' DEPLOYED! Revenue +$' + (p.revenue/1000).toFixed(0) + 'K/mo, Valuation +25%', 'success');
                    } else if (oldProg !== p.progress) {
                        logMessage('ğŸ“ˆ ' + p.name + ': ' + oldProg.toFixed(0) + '% â†’ ' + p.progress.toFixed(0) + '%', 'system');
                    }
                }
            });
            
            gameState.morale = Math.max(20, gameState.morale - (Math.random() * 5 + 2));
            trackChange('morale', oldMorale, gameState.morale);
            
            gameState.competitorThreat += 5;
            if (gameState.competitorThreat >= 70 && Math.random() > 0.5) {
                logMessage('âš ï¸ Anduril announced major contract win. Market pressure increasing!', 'warning');
                gameState.competitorThreat = 50;
            }
            
            gameState.actionPoints = gameState.maxActionPoints;
            
            if (gameState.quarter === 4) {
                gameState.quarter = 1;
                gameState.year++;
            } else {
                gameState.quarter++;
            }
            
            logMessage('â”â”â” START Q' + gameState.quarter + ' ' + gameState.year + ' â”â”â”', 'system');
            
            updateDisplay();
            checkGameStatus();
        }

        function checkGameStatus() {
            const runway = Math.floor(gameState.cash / gameState.burnRate);
            if (runway <= 0 && gameState.cash < 0) {
                logMessage('ğŸ’€ GAME OVER: Out of cash', 'error');
                gameState.gameOver = true;
                showEndGame();
                return;
            }
            if (gameState.morale <= 15 && gameState.quarter > 4) {
                logMessage('ğŸ’€ GAME OVER: Team quit due to low morale', 'error');
                gameState.gameOver = true;
                showEndGame();
                return;
            }
            if (gameState.valuation >= 1000000000) {
                logMessage('ğŸ‰ VICTORY! Unicorn status achieved!', 'success');
                gameState.gameOver = true;
                showEndGame();
                return;
            }
        }

        function showEndGame() {
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'system');
            logMessage('FINAL SCORE', 'system');
            logMessage('Quarters Survived: ' + ((gameState.quarter - 1) + (gameState.year - 2025) * 4), 'system');
            logMessage('Final Valuation: $' + (gameState.valuation/1000000).toFixed(1) + 'M', 'system');
            logMessage('Contracts Won: ' + gameState.contracts.length, 'system');
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'system');
            logMessage('Refresh page to play again', 'system');
        }

        function showReport() {
            logMessage('â”â”â”â”â”â”â”â”â” DETAILED REPORT â”â”â”â”â”â”â”â”â”', 'system');
            logMessage('Q' + gameState.quarter + ' ' + gameState.year + ' | Stage: ' + gameState.fundingRound, 'system');
            logMessage('Cash: $' + (gameState.cash/1000000).toFixed(2) + 'M | Runway: ' + Math.floor(gameState.cash/gameState.burnRate) + ' months', 'system');
            logMessage('Valuation: $' + (gameState.valuation/1000000).toFixed(1) + 'M (Goal: $1,000M)', 'system');
            logMessage('Team: ' + gameState.employees + ' | Morale: ' + Math.round(gameState.morale) + '%', 'system');
            logMessage('Revenue: $' + (gameState.revenue/1000).toFixed(0) + 'K/mo | Burn: $' + (gameState.burnRate/1000).toFixed(0) + 'K/mo', 'system');
            logMessage('Contracts: ' + gameState.contracts.length + ' active', 'system');
            
            Object.keys(gameState.products).forEach(function(key) {
                const p = gameState.products[key];
                logMessage(p.name + ': ' + p.progress.toFixed(0) + '% ' + (p.deployed ? '(DEPLOYED âœ…)' : ''), 'system');
            });
            
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'system');
        }

        document.addEventListener('DOMContentLoaded', function() {
            logMessage('ğŸš€ Welcome to Vanguard Defense Technologies', 'system');
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'system');
            logMessage('ğŸ¯ GOAL: Reach $1B valuation (unicorn status)', 'system');
            logMessage('âš¡ You have 3 ACTION POINTS per quarter - use them wisely!', 'system');
            logMessage('ğŸ’¡ Starting with only $2M cash - every decision matters', 'system');
            logMessage('ğŸ“Š Watch for IMPACT messages showing consequences', 'system');
            logMessage('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'system');
            logMessage('ğŸ’­ STRATEGIC TIP: Focus on ONE product first. Spread too thin = failure.', 'warning');
            updateDisplay();
        });
    </script>
</body>
</html>
